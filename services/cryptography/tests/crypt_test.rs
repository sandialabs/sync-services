use cryptography_service;
use hex::decode;

#[test]
fn keygen_test_seed() {
    let pub_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb3ef540d636d4a9c311ff98e5657d054d08ce36d92597eda8fc22e305603e92569bb0facbedbc045ed3f881ff0ebe1aa5568fff2fd2e2ee0c630c7963fd2d719eafd9b290d8d5828476b591f47fdab49b91c7b4df6cb3db46693667e09a0df26bd063bb207951b616280cd1d89a4ca996f27299692880c365b60dcc07c1ac0519e84588f2c8d99e5267d0e1ddce90dd18f9211fd95385da1ac188789fb1f3fe0042cc8013c147983bb46b10539a8f7f56cfd07c75c582a1ac94166ab0c6ce727c892839f589866be566bafb41e23bcff2126b0cdcf7684e56365f061a8eb2a92d8dfec03b7a7fddada90ec1224feb0dd7567ae79f3eeb193fc0e2dacb951671ce263b0f09f471794d7bc5ec71f8c69b092039502cf51daa601a2c6b1e985b758f36a9e948e326aa7d197423a3384699c4ba2b750373376855b615b47c910c757b8c7a6d6e79d91a79b2015052423ecd33d20927d4ac29a98a50b8152c042a68844dd1ef780179734b57ab17039a5f123bbe2c72920887e8793810f9e1205b561d53e6b4f6deaa06dc93981e3121881b0d457798f979f0999ae1b226f8155ad0173915d49f393394228ee1f1f735d09cc15ce6eaf8a3a6f19a67ef16071c9815eafc76233e00e45c04e622b502a8fd5a1d9f2941f8ee4d0cf5e7d69f2679b6a528ddd2671133dcfcc5ee23bf5a548064817af5ce0b3892e8f34aafba84476696b472076bde9281ae544d3e43b4145ec076b53d5f7d5c8bc2831062edc11f043edf29f05398a6f160ee1b0b016d8bb0b1c23e828c4fdd90708128adf4d70100f75f36065812f6cbe5e9577af1ec548e49206c8a41c229ecd5ac7d0a487c6d921f3e59bacd0a172b67191fec028b4f958840bdf09c43b674380fe7da9f465ce4c4d3d05e8b3504d4125f286bcde1281c7857b8d4e6c14e1e671c8e4068ed1d3e82940ab8ede7afbb9d8f0bf7987bd07401cea32a27ed46bf44ccd3670a9ea49cf037f89f4422a34a8a53afce1ba61ef3c20a9be55b5bb4e67df5cb95d3a17443c195c3ec66cc2515d2c12d7a6c824e1834643621caace611cd1695eb16acdf930d0480a555968c0f882f8d99df8592333868cae4cdf85d93f0118fd07f03cea257cfe4382ef51736f1c1f5a07f7e1dede4e8f9fcd8fbabac4bf9d8a2f08ea1a4a03ec866ac519872f4e4b83023cadd770b9b45cad57a6e5808a6d875f108155c2db9cc05d6eadba204db34efadc2e18da01f691a24cfb31de961bc8f357fe974ba4bee7c943b28ad041464ac0632096ffefcdaead26453861095b54e0f97ed26bf8bc8966441755013d02139723a7f248b165a7a814e67691660a02a322939ed469bdbfc28997f9226123a7191f4adf7287b95e2b64cb18ab5599399646861e8f085c6c201e0c56a46c5c0a9bdd28974dc5f98b1e59ae02b6276c9f4d2236f91ede49907a0f3e74f7649079253108c4a0d667e61eca0cc371e19f36019614752a574c87f4f6e04299fc4867e8b82b439297f6ca7fb04245d87fc21ce4d6080712b12a9e6f64ab18c9f3589f18cb690f04c65db438e2141f70a981c478fc7fb05e2d5e8ef3b3dea9877cf0d76bd030c92a1e30c9e3aae03a1e254c2b9f3b15294ba7c172e0eb9fc042ee58037f548522853f71a87738cb6f0c5ba0057cc4a1299428e36bda12ee12c78f22bf148ab91f0f43fb2d4169c358cd662b54e91a4a2d8db3d4c1de2e9b679cdaece3463535ec65cb46fa68ce863a43fd8eb60895b49a7d06cda3ae950505f86c4199c33cb30d2fb4656e700c52dcc53bb9205df723ee7fe955";
    let sec_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb313b6187e53a50102ad9b4ff1ed4f8c0fe7e55a59be3b6abf2d384a76cb7a7437a360168d7de58b9be1e748423a492d1b07bc927d2fdd05ec1c095b85116d4aaf98a428881631a4c644200148c11060c818901b044d5220715a960019833112144ad002898b186d48880d644269103948c488691334218bb2700c2872ca440e9c1842db02504126491c46415a06254a048d10b369028901639888a4901108c8608b14501aa64458b68dc926890c470a5b88294292810b110a89184aca046d20a5808ac085d1068ecb3249a0440d1448211a23604b202450448d4342281b104998a4101b408a21193040468210918d1834900cc500cba68c828209dca0054940305a804042462c48803123823000424100c84d2308028a1092109800c2428e0a39811ca44021164504b68098c625a3826c8a1808c03465c1380d22353110a44d5b20900906641a2248d30886d1a60889822dd1102c18288092a650920441d400088b0204d2a645c428319a48218c3066031892c93011d006045b000a210165c11645901226a03052142880e40621a1401011a98c0a9071d42221a4a86558340824254603b268101246c9160a1207229c3062c4086448a440c248820117109b821109b00104b5105c42644ca831a0260e21890d934452a2086840066099a084c8242cda44014a2846e3c8119280440bb32512a48c12b50508470e4a260ada804d91a62ca2086e54a05142a66c4b18510b04719992905c106909306e213324d8b6240a478ee148410932221a901199b02418b04cc1288692104e49064cd1b26554266a63a8005c2804e4b809904465cc40280a41815a800024888901358cc9306e61b62482a48413c20422204e129521121552e2b68d62b27098403194140c84382e1ba540e0c61044246de2c46ccc047191246d0ab28010b8641a3602e3046de1828d03b5218194089c986462028858063008c565c8b80000468510390999a00c18b87089286990147121208a24c3510a0309e21291099968424660430866020748dc2412a3069103a08c82b0511a04615a244291b08952b86994126522182dc944018c08711a472de00860d0c20464806d1a260d8a142598222c8b0691d9148acca211603605883644544850114724021301091272c0108a114482042488834490b526d6bc7c4bdd50d47fd92fb9232ebc0573c72e247bd143b5e34ce4f75e9e484ad4bf5af0ad4ea54c903928d3dbd60e8681cdf40bc1e6ae1a51c3f70ed9ad651c8e629c15e360c11d608634e40f7d901c0173a98852641313195df5c424550b6e6d597456408e08c38852acc7e05f3cdf20cfd3dfc54c4adbc1433779d91cb5d6feece41f41ff3698ad9aeab19d7726ee3ce397d0bce0cdd7a67345d0a03b7eb2a7eb196d26ac40abd7ba58b66b1efa5b474c59bf6cca93f995192d848b475b34565436adc58d373eedddbb3f56e4342c231683c5f5a1f3939746de04649a770e7e63fa5d4f88afb408c832595f7cb4bf0ea9d2c958648e0353129f1c0286372761dc3a5f9250463637e17fe6a1f798f2b49f47cbf62be5759ffbcf9c7ca822457d72f370b1fa24a96f1b8adc1dd72dac2b7e8d8e6b6a2ad08e65ee06940e6c126b748bb1c29fa16933f69a9764b3d3c1f7a8ae4c3e8f2365adfc6d87f59ee56f63c63aea472017fbc88ad0b6922c7368580437dd431100e62690a67e45706687aef0392222ef550ab356b8cf3664c0216366c40a5d0719bfae46f20f5d3e741d29f767ca87f42f894146fd1591bb013f833400b4423afaa414d473cf27337790240368c38405e9bcf89eae77649c9e9fe22b8c6067bf94db6713f92dab5b5208e6feb4be2109fcd9f63a968a43d4aa5466fb4e4f0224b11cfe3a9613b037c6be5e7660cceacf7f74b4a3c1f4d9d266428013b3d545270ff7f4119eadf59eedf59e0603a3a38d32881646fd38d7b173eb651632a1b777ffa3fd8c43d83e5fea28bd79439c48f3e2c5153b2163f61e8ed2a6431c27887d0b60e18149983c859579630c5ba194ec32b81469bcc0724ce6a9e71a8fff976e347d1fe835558b517eb3b0c7e7594ff918a1836f06ca51750de2027a883634a59c5bd1b0475f706d7f1690747ba7a3d190dd3fccbf539c60a526aaa392b67274d81c2f72b44bcbb23067da9fc2b6ad74a90c71334ed44c315dd776b2c500691f31cf90e4d94632cbb2638f7ebabecdf8c7e7383d7b5a40ecf798dbfe057a19d0e34280392146291044527b2a37a57e8a55e42b66b5d9566a10a790b862d9d25f1182a4020a07db383408ed21cd5c08a05eab2a599d1ecda6f0a974c3d001158be01276e287ed1b553eb1a4ace30a00f3465ac09661309ad7d9923d6f6eeabbdd1a1d006458c68c1317c90cb1e0ec46395371e242e296d5de85f5e5cc32e4a7278e01e53046c4f14e428ded0f3761a89b6262096ebeb9ee0ed5e5d8d0c8bbec85cd4956b9527ee0c23c0f33c30eb69c5653e7f08a057eea4dc6e76c1fe72a4cfab44c77f3f6482f55a00ca384c344ba77a8506ecc292d621efaae8b12c3b3c0d846915d8a065d10e4ea07101310b8adc65e92d60617079a27a1a851de19a2803dcc3ded1446c1d8641d40ab65937e94797c78e05eac4b40f2911f75baa6a046016d8883fbdbd72a6deabb137307673e67cbe6333d9128f38d931effc10d2fcff2755058057b3e92b7171b7eeb65a3738355d50d1dc72823abe3a0f15c6213e44713d426b2eee3c1e38c3620c6dac12e34754443b904d51ac240627c35befc768c27db11339408963f45032aff1f5edbccebbde490866fdeefc442341467f1549f3d3dc9628a4ba1dbbbd09c5ff160b00564792b5cfef0d4cf4ead40bce32807d98aeff9c5e1151d3c2f98cdf210f1d9942ad27b7de9023f68656a4c0a00cf35f6e7cfc7e1a2e00b1ab38951d6adde239c7c662070dab08fbcaec3a7aa46a2d452d7d9dcd4482144fad916c500407c295cf5ecfa2dc8c6f0111b3e83d871a0445a9f5d6eeb4fb5df3c6544c83bc3291e9130abdf64eaa142e95254ca29ea5e090c706da778f7db18001b7f03cb260d043efeb825c8adc560e0fea1026197f14564d56b436ad4995d5eb1bf510826e64ac030ac26057612ae8ecd9cee40911d04c7b9c370723bfc9fe65b70d52c81b4137f61eb9f78df8877b15416de97429173f768a5beff9546fb71363f8acff5d9c063e50b2fac5693b5d9b2a0e3ac1a851f9fc1dfc16c1a22b86e49197f9b6264b3db7ab244a9b68a1581b06fb883fc12997c144103d6d022d960975b205e37e55651b94bdbdd562d84b81ef1f518377375fb8545a3824f831fef18ffcd20d9794a5fae519609205f5247eefa0031ded245c7bbea21b9cf42d59e5cd20e225bfd3ee5f25503e13ea0ccf84512a1710921c9e5fa3b629281920036663b391c1c7ba544ea1aa4807aa484c67f2122c761f4611e54f154136130e0e8cee17d7f42ceba5920ed9e8136587ac4d4b37d86378353c21d50af14d035558b5e";


    let (pub_key_str_gen, sec_key_str_gen) = cryptography_service::mldsa2_keygen(Some("baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad"));// If you want to use a seed string
    //let (pub_key_str, sec_key_str) = cryptography_service::mldsa2_keygen(Some("baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad"));// If you want to use a seed string and see what happens if it's a nibble short
    //let (pub_key_str, sec_key_str) = cryptography_service::mldsa2_keygen(Some("baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad"));// If you want to use a seed string and see what happens if it's a byte short
    //let (pub_key_str, sec_key_str) = cryptography_service::altmldsa2_keygen(None);//If you don't want to use a seed string
    //let sig = sig.replace("a", "b"); //uncomment this line if you want to alter the signature to make sure verification fails
    assert_eq!(pub_key_str_gen, pub_truth);
    assert_eq!(sec_key_str_gen, sec_truth);

    let (pub_key_bytes, sec_key_bytes) = cryptography_service::bmldsa2_keygen(Some(decode("baaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad").unwrap()));
    let pub_truth_b: [u8; 1312] = decode(pub_truth.to_string()).unwrap().try_into().expect("pubkey wrong length");
    let sec_truth_b: [u8; 2528] = decode(sec_truth.to_string()).unwrap().try_into().expect("seckey wrong length");
    assert_eq!(pub_key_bytes, pub_truth_b);
    assert_eq!(sec_key_bytes, sec_truth_b);
}

#[test]
fn sig_test() {
    let m = "lametestmessage";
    let sig_truth = "8ced7004e6dd8e421ec2009234807e93987739ea4556a7e142c5077cee1f02278639de805137447b3dd15d3260fc0d2ba7a563b0938b6bad9deee1d5da9b4cc4a692da691157ce8bcd782383d209fd1fad31157cab342f4cc1a6789d109a089acb9be55a6d4b4a8705ab7ebaedd89692791004250bb5727c9030305e24f197f69e0e64e1e724117f37a216d3ba76e8decf002a1f7b88017f3894712cf30862123dbef76ebb44ef03fa3dff0e0b1498220e41064b452f46422587a51cec9b63bed7f5887149889037f191eb1a47284578ab215644b237f7376f6c13321ee57aa8ec2b6180370dee50cc03d4ab604504620ba61e8f028c6f32fc91d33a0aafd81a0fe421c50218a8a97b677d74491b9d9294cb1820a7fc4555a34eff5861cb8c0afd877a64dfdcd5606327c0acb144cf40cdd76280ab3bdfc66accf1a7eecd663453e4b7d610242bfac2af9cd7a5219187c3a4247953313d5d0696b7a1336e78f48412182b9184f33c5bc3bcdf39ede62f4c0e36094f53b97fa27d896bb39f21f76b52a758b521ac77190f8ef84a077f642f538e1d9b7e4338e4a3a378d46c0b804c001e1cdc1843221a016920fdf5132ca407506a45e836d3aab03143b3f5b4d6ba330a0d9eac50f5a238d72640da256122bf329ac86bd215afe6286a5add14219af768a4dd6e292490b8e0ee25e470c9577ba5810395328eb980c5932b47232f303d73192e77dc4b3fd8a49f5bfe0447b24006aa27d18dc7b09222bcf19c117d3aab745840d4133dcb22d5adc9ed16fd803eb33f9c85c7f12284190ad63cd5314d42484860befd24479db1b8f75be4e76e6fcd982ab6203549702f497a25495446816e1eba257452c03cf72fd8bd955c620a031fb421a6b12d657a6a958e7fbca5cb2deb5d240e02fc0fa292593ebbf826653b39b1092b7cbd3c919c4b1999b7fdbe54476b302174e4876d6ab970a333072b71d6fa68323ec9c26594cbac595d75fd0fa07bcc3a6d6e240e56c7d0dc7e5e4affe8ab4cf799ad058c9f8bd79da000aeaae9a31f4ad70d4f81b37b272770a34c8fb0fb1896ab1724612c0f271da474c45d19993ea681c5e95295ed9693cb50eca9033a66b5146e8d92665c7badc721d3f445230d95d6b0261b12be4a874f4c3efac4d712b9d5c9d96cd1a60f14eaaa299bea4166c8108c1bfc35769d7c28cbe3a7a554e4585c9de9cc9766643cd358ecc70a736f7c9ad859f8b62975c812946be87c92d57b857efbd70b61f7d64fbc3e4fbe284cf87571679d00dcd70ae665fc05b60ab8590160dff2abd6c0b8fc3d4ca9ba1c67d628fb334643ef7b7686f39e8fb089e10e41b584c4e754e786ac714e87df631aa05411dcb8d2f8ec9b8ec42491fd565893140604ebe120234bf002fcc42344c862f1c9e5467b346b69683456477d25da14490d9a0d97c52927f6ffbc33e896c702c6d7543903e0bbafb7dc98b9f5b276234905d71220b7c39dc38206d7c3cf71f01e272d436338a7ed640c1838375007c3d261ea2dc2e67e71e102c2d040fcebc28712285e79e3065f28ecf619bc45dd4aec87d64d9ab8c8b4acee89ea40ca6801ccdc5a91353f12699a6c8e1665b12e0d419f6b153cd846e456fa53d6a1c16a76c1cbd10d3f131537975a26571ff98f66e2b49d4313e250475b9d379286a0ec8d4c464f875401a34d58a1fe630215c329a3880550d5c1d5973a09b82ee17d308d738a9dcda140405f7a3c600808e767e89d4a134f27b266b8bb3443cd6dc77bd02df41cbbdee30b3059317cf91d58ee2b0702ce500bd3abbff86666b30951488f090fcc2a669272b0b0aade3e7042b6fd6ed30440d5a57c69573a199b4b940de6fbb20fb4e1f4c35e95c2fa00c46ab138edf78566ec998bec7101cf12e04015e3229704728d261356b825e00f4f46e03b63e1affa7491079912e57127f2fe265ccd310df25e12c28ca18feb46bf9a2081fc8ff612c63a0b82f345f8f830418fb131d54367272242c4c9744467ebf395d75c0b7620943204a68f759fb8c89b545f8baa18121458e6ecc70d87116c61d977954139d8401d109440ff5c53db96c5ae7218de2f98a64a2cc834248d8393c034a76edcf408ec30aca68d29a43cf48d41222e74c7224e154de7ec34362c15433927d2b42f4cee2b3a24165448ebf1349a926719c91519d7f00ca639c7ed36d6c1fa875a5de4bb6ca52826d84037d04a98993bade17421a6a5fd71cc9724c3d47b007087bf6bd44c6e8ba6305b470bcbb91f0269a9ccbe94b5cacd2c37a4e82cd7d69fa1b134f9f3604214c4e08ef1479d41af46a5bb26eab0dc702266501e4d90b8113f2fcaf903abfd2a8e7f39616c4150521aeea7c44957538bbf12950c9eb6b6bde852b0dc873430e902bf7647fc86d86715f5fadcc4241dc74681affc4ae621942ad030f711a6b018fad3b97b0f0b3b95698d75e264f61b534271c16587464f6686137e9b53423c7ff7416c228bd7e3710d5c174e53e4e5f9f2f7602619bc528fffa777dd3102dd5fea65eaf9ae5cf9c33af86b0dd50ee15025f328ec065f94e4ccea8ac9c05339c23f22ec50f06b8f9f42b7a259d9f83ba89cd4be59062b46a2f00a881d0e042cfff5f2b2958ee1ba7eb4551050ffebed2ce8c4782a583ed9b1ed9808e06527cdac61d78a52d98eadc23936704343a9d1b7df6e46864134c6b927d2ed865ecb9b037b8de7917ee347230aaae4826fa3899f7a8ca639ee27580d8d1632a7bd6416bd6a96c88efe4511fd88dcf627ce100c0276582a9e0d195b814e6c1dc4347c2a8ba459eceefee432238868828f765777d365cb3f4e24b69cb10c4554988e3eff77213c08ffa9ab279a8aab92691f1e366bc8b5577d08501fa4d90b2dae82ac8f3a5d689cef342b9b0faf7274bf7597c88a8eb9368ab910b189b683ff81ceaf0b24c598bc9462ae1fc07e27afe5c92e67051e47375e3d52feb455fce743ee64b930f7b16c47f1116a0968aec77d0d05950dfb6dda65ce042951414b220966cb3bd5b650edaf1a1020ba460170591bbe918f8d8660627384031720dd1e775afe67191e3fc0dd2522893da6e4a7d1eae0150d6b8d8de2ee0bdf43ee84a6e0b0fd259f1fa42d4e51b608e878866222a3de10f67ba8124c40d65eee7d2db6670f5eb21e3a87d318009bd437b0f770ee3403b614ead64429a7c59643d533e77dbf86f6336e34205098618b8f12c197e6fab51a4ca7b81297491b34da54209a007011bf1d04f4e99eaf7dedc9695e090ed1769a0759de5726f62a5e799c3c221c7ed897121a1e2c5e6468698c9dabb0c7dae8043e4652595a6794a3b9c1d4dce8fcfd183c414447728296a9b6bfdbf83a404a516a76797e8eb8bec3fe00000000000000000000000000000000000000000000000f1f2c39";
    let sec_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb313b6187e53a50102ad9b4ff1ed4f8c0fe7e55a59be3b6abf2d384a76cb7a7437a360168d7de58b9be1e748423a492d1b07bc927d2fdd05ec1c095b85116d4aaf98a428881631a4c644200148c11060c818901b044d5220715a960019833112144ad002898b186d48880d644269103948c488691334218bb2700c2872ca440e9c1842db02504126491c46415a06254a048d10b369028901639888a4901108c8608b14501aa64458b68dc926890c470a5b88294292810b110a89184aca046d20a5808ac085d1068ecb3249a0440d1448211a23604b202450448d4342281b104998a4101b408a21193040468210918d1834900cc500cba68c828209dca0054940305a804042462c48803123823000424100c84d2308028a1092109800c2428e0a39811ca44021164504b68098c625a3826c8a1808c03465c1380d22353110a44d5b20900906641a2248d30886d1a60889822dd1102c18288092a650920441d400088b0204d2a645c428319a48218c3066031892c93011d006045b000a210165c11645901226a03052142880e40621a1401011a98c0a9071d42221a4a86558340824254603b268101246c9160a1207229c3062c4086448a440c248820117109b821109b00104b5105c42644ca831a0260e21890d934452a2086840066099a084c8242cda44014a2846e3c8119280440bb32512a48c12b50508470e4a260ada804d91a62ca2086e54a05142a66c4b18510b04719992905c106909306e213324d8b6240a478ee148410932221a901199b02418b04cc1288692104e49064cd1b26554266a63a8005c2804e4b809904465cc40280a41815a800024888901358cc9306e61b62482a48413c20422204e129521121552e2b68d62b27098403194140c84382e1ba540e0c61044246de2c46ccc047191246d0ab28010b8641a3602e3046de1828d03b5218194089c986462028858063008c565c8b80000468510390999a00c18b87089286990147121208a24c3510a0309e21291099968424660430866020748dc2412a3069103a08c82b0511a04615a244291b08952b86994126522182dc944018c08711a472de00860d0c20464806d1a260d8a142598222c8b0691d9148acca211603605883644544850114724021301091272c0108a114482042488834490b526d6bc7c4bdd50d47fd92fb9232ebc0573c72e247bd143b5e34ce4f75e9e484ad4bf5af0ad4ea54c903928d3dbd60e8681cdf40bc1e6ae1a51c3f70ed9ad651c8e629c15e360c11d608634e40f7d901c0173a98852641313195df5c424550b6e6d597456408e08c38852acc7e05f3cdf20cfd3dfc54c4adbc1433779d91cb5d6feece41f41ff3698ad9aeab19d7726ee3ce397d0bce0cdd7a67345d0a03b7eb2a7eb196d26ac40abd7ba58b66b1efa5b474c59bf6cca93f995192d848b475b34565436adc58d373eedddbb3f56e4342c231683c5f5a1f3939746de04649a770e7e63fa5d4f88afb408c832595f7cb4bf0ea9d2c958648e0353129f1c0286372761dc3a5f9250463637e17fe6a1f798f2b49f47cbf62be5759ffbcf9c7ca822457d72f370b1fa24a96f1b8adc1dd72dac2b7e8d8e6b6a2ad08e65ee06940e6c126b748bb1c29fa16933f69a9764b3d3c1f7a8ae4c3e8f2365adfc6d87f59ee56f63c63aea472017fbc88ad0b6922c7368580437dd431100e62690a67e45706687aef0392222ef550ab356b8cf3664c0216366c40a5d0719bfae46f20f5d3e741d29f767ca87f42f894146fd1591bb013f833400b4423afaa414d473cf27337790240368c38405e9bcf89eae77649c9e9fe22b8c6067bf94db6713f92dab5b5208e6feb4be2109fcd9f63a968a43d4aa5466fb4e4f0224b11cfe3a9613b037c6be5e7660cceacf7f74b4a3c1f4d9d266428013b3d545270ff7f4119eadf59eedf59e0603a3a38d32881646fd38d7b173eb651632a1b777ffa3fd8c43d83e5fea28bd79439c48f3e2c5153b2163f61e8ed2a6431c27887d0b60e18149983c859579630c5ba194ec32b81469bcc0724ce6a9e71a8fff976e347d1fe835558b517eb3b0c7e7594ff918a1836f06ca51750de2027a883634a59c5bd1b0475f706d7f1690747ba7a3d190dd3fccbf539c60a526aaa392b67274d81c2f72b44bcbb23067da9fc2b6ad74a90c71334ed44c315dd776b2c500691f31cf90e4d94632cbb2638f7ebabecdf8c7e7383d7b5a40ecf798dbfe057a19d0e34280392146291044527b2a37a57e8a55e42b66b5d9566a10a790b862d9d25f1182a4020a07db383408ed21cd5c08a05eab2a599d1ecda6f0a974c3d001158be01276e287ed1b553eb1a4ace30a00f3465ac09661309ad7d9923d6f6eeabbdd1a1d006458c68c1317c90cb1e0ec46395371e242e296d5de85f5e5cc32e4a7278e01e53046c4f14e428ded0f3761a89b6262096ebeb9ee0ed5e5d8d0c8bbec85cd4956b9527ee0c23c0f33c30eb69c5653e7f08a057eea4dc6e76c1fe72a4cfab44c77f3f6482f55a00ca384c344ba77a8506ecc292d621efaae8b12c3b3c0d846915d8a065d10e4ea07101310b8adc65e92d60617079a27a1a851de19a2803dcc3ded1446c1d8641d40ab65937e94797c78e05eac4b40f2911f75baa6a046016d8883fbdbd72a6deabb137307673e67cbe6333d9128f38d931effc10d2fcff2755058057b3e92b7171b7eeb65a3738355d50d1dc72823abe3a0f15c6213e44713d426b2eee3c1e38c3620c6dac12e34754443b904d51ac240627c35befc768c27db11339408963f45032aff1f5edbccebbde490866fdeefc442341467f1549f3d3dc9628a4ba1dbbbd09c5ff160b00564792b5cfef0d4cf4ead40bce32807d98aeff9c5e1151d3c2f98cdf210f1d9942ad27b7de9023f68656a4c0a00cf35f6e7cfc7e1a2e00b1ab38951d6adde239c7c662070dab08fbcaec3a7aa46a2d452d7d9dcd4482144fad916c500407c295cf5ecfa2dc8c6f0111b3e83d871a0445a9f5d6eeb4fb5df3c6544c83bc3291e9130abdf64eaa142e95254ca29ea5e090c706da778f7db18001b7f03cb260d043efeb825c8adc560e0fea1026197f14564d56b436ad4995d5eb1bf510826e64ac030ac26057612ae8ecd9cee40911d04c7b9c370723bfc9fe65b70d52c81b4137f61eb9f78df8877b15416de97429173f768a5beff9546fb71363f8acff5d9c063e50b2fac5693b5d9b2a0e3ac1a851f9fc1dfc16c1a22b86e49197f9b6264b3db7ab244a9b68a1581b06fb883fc12997c144103d6d022d960975b205e37e55651b94bdbdd562d84b81ef1f518377375fb8545a3824f831fef18ffcd20d9794a5fae519609205f5247eefa0031ded245c7bbea21b9cf42d59e5cd20e225bfd3ee5f25503e13ea0ccf84512a1710921c9e5fa3b629281920036663b391c1c7ba544ea1aa4807aa484c67f2122c761f4611e54f154136130e0e8cee17d7f42ceba5920ed9e8136587ac4d4b37d86378353c21d50af14d035558b5e";
    let sig = cryptography_service::mldsa2_sign(sec_truth.to_string(), m);
    assert_eq!(sig, sig_truth);
    let sigb = cryptography_service::bmldsa2_sign(decode(sec_truth.to_string()).unwrap(), m.as_bytes());
    let sig_truth_b: [u8; 2420] = decode(sig_truth.to_string()).unwrap().try_into().expect("Sig wrong length");
    assert_eq!(sigb, sig_truth_b);
}

#[test]
fn verify_test() {
    let m = "lametestmessage";
    let pub_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb3ef540d636d4a9c311ff98e5657d054d08ce36d92597eda8fc22e305603e92569bb0facbedbc045ed3f881ff0ebe1aa5568fff2fd2e2ee0c630c7963fd2d719eafd9b290d8d5828476b591f47fdab49b91c7b4df6cb3db46693667e09a0df26bd063bb207951b616280cd1d89a4ca996f27299692880c365b60dcc07c1ac0519e84588f2c8d99e5267d0e1ddce90dd18f9211fd95385da1ac188789fb1f3fe0042cc8013c147983bb46b10539a8f7f56cfd07c75c582a1ac94166ab0c6ce727c892839f589866be566bafb41e23bcff2126b0cdcf7684e56365f061a8eb2a92d8dfec03b7a7fddada90ec1224feb0dd7567ae79f3eeb193fc0e2dacb951671ce263b0f09f471794d7bc5ec71f8c69b092039502cf51daa601a2c6b1e985b758f36a9e948e326aa7d197423a3384699c4ba2b750373376855b615b47c910c757b8c7a6d6e79d91a79b2015052423ecd33d20927d4ac29a98a50b8152c042a68844dd1ef780179734b57ab17039a5f123bbe2c72920887e8793810f9e1205b561d53e6b4f6deaa06dc93981e3121881b0d457798f979f0999ae1b226f8155ad0173915d49f393394228ee1f1f735d09cc15ce6eaf8a3a6f19a67ef16071c9815eafc76233e00e45c04e622b502a8fd5a1d9f2941f8ee4d0cf5e7d69f2679b6a528ddd2671133dcfcc5ee23bf5a548064817af5ce0b3892e8f34aafba84476696b472076bde9281ae544d3e43b4145ec076b53d5f7d5c8bc2831062edc11f043edf29f05398a6f160ee1b0b016d8bb0b1c23e828c4fdd90708128adf4d70100f75f36065812f6cbe5e9577af1ec548e49206c8a41c229ecd5ac7d0a487c6d921f3e59bacd0a172b67191fec028b4f958840bdf09c43b674380fe7da9f465ce4c4d3d05e8b3504d4125f286bcde1281c7857b8d4e6c14e1e671c8e4068ed1d3e82940ab8ede7afbb9d8f0bf7987bd07401cea32a27ed46bf44ccd3670a9ea49cf037f89f4422a34a8a53afce1ba61ef3c20a9be55b5bb4e67df5cb95d3a17443c195c3ec66cc2515d2c12d7a6c824e1834643621caace611cd1695eb16acdf930d0480a555968c0f882f8d99df8592333868cae4cdf85d93f0118fd07f03cea257cfe4382ef51736f1c1f5a07f7e1dede4e8f9fcd8fbabac4bf9d8a2f08ea1a4a03ec866ac519872f4e4b83023cadd770b9b45cad57a6e5808a6d875f108155c2db9cc05d6eadba204db34efadc2e18da01f691a24cfb31de961bc8f357fe974ba4bee7c943b28ad041464ac0632096ffefcdaead26453861095b54e0f97ed26bf8bc8966441755013d02139723a7f248b165a7a814e67691660a02a322939ed469bdbfc28997f9226123a7191f4adf7287b95e2b64cb18ab5599399646861e8f085c6c201e0c56a46c5c0a9bdd28974dc5f98b1e59ae02b6276c9f4d2236f91ede49907a0f3e74f7649079253108c4a0d667e61eca0cc371e19f36019614752a574c87f4f6e04299fc4867e8b82b439297f6ca7fb04245d87fc21ce4d6080712b12a9e6f64ab18c9f3589f18cb690f04c65db438e2141f70a981c478fc7fb05e2d5e8ef3b3dea9877cf0d76bd030c92a1e30c9e3aae03a1e254c2b9f3b15294ba7c172e0eb9fc042ee58037f548522853f71a87738cb6f0c5ba0057cc4a1299428e36bda12ee12c78f22bf148ab91f0f43fb2d4169c358cd662b54e91a4a2d8db3d4c1de2e9b679cdaece3463535ec65cb46fa68ce863a43fd8eb60895b49a7d06cda3ae950505f86c4199c33cb30d2fb4656e700c52dcc53bb9205df723ee7fe955";
    let sig_truth = "8ced7004e6dd8e421ec2009234807e93987739ea4556a7e142c5077cee1f02278639de805137447b3dd15d3260fc0d2ba7a563b0938b6bad9deee1d5da9b4cc4a692da691157ce8bcd782383d209fd1fad31157cab342f4cc1a6789d109a089acb9be55a6d4b4a8705ab7ebaedd89692791004250bb5727c9030305e24f197f69e0e64e1e724117f37a216d3ba76e8decf002a1f7b88017f3894712cf30862123dbef76ebb44ef03fa3dff0e0b1498220e41064b452f46422587a51cec9b63bed7f5887149889037f191eb1a47284578ab215644b237f7376f6c13321ee57aa8ec2b6180370dee50cc03d4ab604504620ba61e8f028c6f32fc91d33a0aafd81a0fe421c50218a8a97b677d74491b9d9294cb1820a7fc4555a34eff5861cb8c0afd877a64dfdcd5606327c0acb144cf40cdd76280ab3bdfc66accf1a7eecd663453e4b7d610242bfac2af9cd7a5219187c3a4247953313d5d0696b7a1336e78f48412182b9184f33c5bc3bcdf39ede62f4c0e36094f53b97fa27d896bb39f21f76b52a758b521ac77190f8ef84a077f642f538e1d9b7e4338e4a3a378d46c0b804c001e1cdc1843221a016920fdf5132ca407506a45e836d3aab03143b3f5b4d6ba330a0d9eac50f5a238d72640da256122bf329ac86bd215afe6286a5add14219af768a4dd6e292490b8e0ee25e470c9577ba5810395328eb980c5932b47232f303d73192e77dc4b3fd8a49f5bfe0447b24006aa27d18dc7b09222bcf19c117d3aab745840d4133dcb22d5adc9ed16fd803eb33f9c85c7f12284190ad63cd5314d42484860befd24479db1b8f75be4e76e6fcd982ab6203549702f497a25495446816e1eba257452c03cf72fd8bd955c620a031fb421a6b12d657a6a958e7fbca5cb2deb5d240e02fc0fa292593ebbf826653b39b1092b7cbd3c919c4b1999b7fdbe54476b302174e4876d6ab970a333072b71d6fa68323ec9c26594cbac595d75fd0fa07bcc3a6d6e240e56c7d0dc7e5e4affe8ab4cf799ad058c9f8bd79da000aeaae9a31f4ad70d4f81b37b272770a34c8fb0fb1896ab1724612c0f271da474c45d19993ea681c5e95295ed9693cb50eca9033a66b5146e8d92665c7badc721d3f445230d95d6b0261b12be4a874f4c3efac4d712b9d5c9d96cd1a60f14eaaa299bea4166c8108c1bfc35769d7c28cbe3a7a554e4585c9de9cc9766643cd358ecc70a736f7c9ad859f8b62975c812946be87c92d57b857efbd70b61f7d64fbc3e4fbe284cf87571679d00dcd70ae665fc05b60ab8590160dff2abd6c0b8fc3d4ca9ba1c67d628fb334643ef7b7686f39e8fb089e10e41b584c4e754e786ac714e87df631aa05411dcb8d2f8ec9b8ec42491fd565893140604ebe120234bf002fcc42344c862f1c9e5467b346b69683456477d25da14490d9a0d97c52927f6ffbc33e896c702c6d7543903e0bbafb7dc98b9f5b276234905d71220b7c39dc38206d7c3cf71f01e272d436338a7ed640c1838375007c3d261ea2dc2e67e71e102c2d040fcebc28712285e79e3065f28ecf619bc45dd4aec87d64d9ab8c8b4acee89ea40ca6801ccdc5a91353f12699a6c8e1665b12e0d419f6b153cd846e456fa53d6a1c16a76c1cbd10d3f131537975a26571ff98f66e2b49d4313e250475b9d379286a0ec8d4c464f875401a34d58a1fe630215c329a3880550d5c1d5973a09b82ee17d308d738a9dcda140405f7a3c600808e767e89d4a134f27b266b8bb3443cd6dc77bd02df41cbbdee30b3059317cf91d58ee2b0702ce500bd3abbff86666b30951488f090fcc2a669272b0b0aade3e7042b6fd6ed30440d5a57c69573a199b4b940de6fbb20fb4e1f4c35e95c2fa00c46ab138edf78566ec998bec7101cf12e04015e3229704728d261356b825e00f4f46e03b63e1affa7491079912e57127f2fe265ccd310df25e12c28ca18feb46bf9a2081fc8ff612c63a0b82f345f8f830418fb131d54367272242c4c9744467ebf395d75c0b7620943204a68f759fb8c89b545f8baa18121458e6ecc70d87116c61d977954139d8401d109440ff5c53db96c5ae7218de2f98a64a2cc834248d8393c034a76edcf408ec30aca68d29a43cf48d41222e74c7224e154de7ec34362c15433927d2b42f4cee2b3a24165448ebf1349a926719c91519d7f00ca639c7ed36d6c1fa875a5de4bb6ca52826d84037d04a98993bade17421a6a5fd71cc9724c3d47b007087bf6bd44c6e8ba6305b470bcbb91f0269a9ccbe94b5cacd2c37a4e82cd7d69fa1b134f9f3604214c4e08ef1479d41af46a5bb26eab0dc702266501e4d90b8113f2fcaf903abfd2a8e7f39616c4150521aeea7c44957538bbf12950c9eb6b6bde852b0dc873430e902bf7647fc86d86715f5fadcc4241dc74681affc4ae621942ad030f711a6b018fad3b97b0f0b3b95698d75e264f61b534271c16587464f6686137e9b53423c7ff7416c228bd7e3710d5c174e53e4e5f9f2f7602619bc528fffa777dd3102dd5fea65eaf9ae5cf9c33af86b0dd50ee15025f328ec065f94e4ccea8ac9c05339c23f22ec50f06b8f9f42b7a259d9f83ba89cd4be59062b46a2f00a881d0e042cfff5f2b2958ee1ba7eb4551050ffebed2ce8c4782a583ed9b1ed9808e06527cdac61d78a52d98eadc23936704343a9d1b7df6e46864134c6b927d2ed865ecb9b037b8de7917ee347230aaae4826fa3899f7a8ca639ee27580d8d1632a7bd6416bd6a96c88efe4511fd88dcf627ce100c0276582a9e0d195b814e6c1dc4347c2a8ba459eceefee432238868828f765777d365cb3f4e24b69cb10c4554988e3eff77213c08ffa9ab279a8aab92691f1e366bc8b5577d08501fa4d90b2dae82ac8f3a5d689cef342b9b0faf7274bf7597c88a8eb9368ab910b189b683ff81ceaf0b24c598bc9462ae1fc07e27afe5c92e67051e47375e3d52feb455fce743ee64b930f7b16c47f1116a0968aec77d0d05950dfb6dda65ce042951414b220966cb3bd5b650edaf1a1020ba460170591bbe918f8d8660627384031720dd1e775afe67191e3fc0dd2522893da6e4a7d1eae0150d6b8d8de2ee0bdf43ee84a6e0b0fd259f1fa42d4e51b608e878866222a3de10f67ba8124c40d65eee7d2db6670f5eb21e3a87d318009bd437b0f770ee3403b614ead64429a7c59643d533e77dbf86f6336e34205098618b8f12c197e6fab51a4ca7b81297491b34da54209a007011bf1d04f4e99eaf7dedc9695e090ed1769a0759de5726f62a5e799c3c221c7ed897121a1e2c5e6468698c9dabb0c7dae8043e4652595a6794a3b9c1d4dce8fcfd183c414447728296a9b6bfdbf83a404a516a76797e8eb8bec3fe00000000000000000000000000000000000000000000000f1f2c39";
    let c =cryptography_service::mldsa2_verify(pub_truth.to_string(), m, sig_truth.to_string()).unwrap();
    let mut v = false;
    if c == (){
        v = true;
    }
    assert_eq!(v, true);

    let cb = cryptography_service::bmldsa2_verify(decode(pub_truth.to_string()).unwrap(), m.as_bytes(), decode(sig_truth.to_string()).unwrap()).unwrap();
    let mut vb = false;
    if cb == (){
        vb = true;
    }
    assert_eq!(vb, true);
}

#[test]
#[should_panic]
fn verify_fail_test_pk_wrong() {
    let m = "lametestmessage";
    let pub_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb3ef540d636d4a9c311ff98e5657d054d08ce36d92597eda8fc22e305603e92569bb0facbedbc045ed3f881ff0ebe1aa5568fff2fd2e2ee0c630c7963fd2d719eafd9b290d8d5828476b591f47fdab49b91c7b4df6cb3db46693667e09a0df26bd063bb207951b616280cd1d89a4ca996f27299692880c365b60dcc07c1ac0519e84588f2c8d99e5267d0e1ddce90dd18f9211fd95385da1ac188789fb1f3fe0042cc8013c147983bb46b10539a8f7f56cfd07c75c582a1ac94166ab0c6ce727c892839f589866be566bafb41e23bcff2126b0cdcf7684e56365f061a8eb2a92d8dfec03b7a7fddada90ec1224feb0dd7567ae79f3eeb193fc0e2dacb951671ce263b0f09f471794d7bc5ec71f8c69b092039502cf51daa601a2c6b1e985b758f36a9e948e326aa7d197423a3384699c4ba2b750373376855b615b47c910c757b8c7a6d6e79d91a79b2015052423ecd33d20927d4ac29a98a50b8152c042a68844dd1ef780179734b57ab17039a5f123bbe2c72920887e8793810f9e1205b561d53e6b4f6deaa06dc93981e3121881b0d457798f979f0999ae1b226f8155ad0173915d49f393394228ee1f1f735d09cc15ce6eaf8a3a6f19a67ef16071c9815eafc76233e00e45c04e622b502a8fd5a1d9f2941f8ee4d0cf5e7d69f2679b6a528ddd2671133dcfcc5ee23bf5a548064817af5ce0b3892e8f34aafba84476696b472076bde9281ae544d3e43b4145ec076b53d5f7d5c8bc2831062edc11f043edf29f05398a6f160ee1b0b016d8bb0b1c23e828c4fdd90708128adf4d70100f75f36065812f6cbe5e9577af1ec548e49206c8a41c229ecd5ac7d0a487c6d921f3e59bacd0a172b67191fec028b4f958840bdf09c43b674380fe7da9f465ce4c4d3d05e8b3504d4125f286bcde1281c7857b8d4e6c14e1e671c8e4068ed1d3e82940ab8ede7afbb9d8f0bf7987bd07401cea32a27ed46bf44ccd3670a9ea49cf037f89f4422a34a8a53afce1ba61ef3c20a9be55b5bb4e67df5cb95d3a17443c195c3ec66cc2515d2c12d7a6c824e1834643621caace611cd1695eb16acdf930d0480a555968c0f882f8d99df8592333868cae4cdf85d93f0118fd07f03cea257cfe4382ef51736f1c1f5a07f7e1dede4e8f9fcd8fbabac4bf9d8a2f08ea1a4a03ec866ac519872f4e4b83023cadd770b9b45cad57a6e5808a6d875f108155c2db9cc05d6eadba204db34efadc2e18da01f691a24cfb31de961bc8f357fe974ba4bee7c943b28ad041464ac0632096ffefcdaead26453861095b54e0f97ed26bf8bc8966441755013d02139723a7f248b165a7a814e67691660a02a322939ed469bdbfc28997f9226123a7191f4adf7287b95e2b64cb18ab5599399646861e8f085c6c201e0c56a46c5c0a9bdd28974dc5f98b1e59ae02b6276c9f4d2236f91ede49907a0f3e74f7649079253108c4a0d667e61eca0cc371e19f36019614752a574c87f4f6e04299fc4867e8b82b439297f6ca7fb04245d87fc21ce4d6080712b12a9e6f64ab18c9f3589f18cb690f04c65db438e2141f70a981c478fc7fb05e2d5e8ef3b3dea9877cf0d76bd030c92a1e30c9e3aae03a1e254c2b9f3b15294ba7c172e0eb9fc042ee58037f548522853f71a87738cb6f0c5ba0057cc4a1299428e36bda12ee12c78f22bf148ab91f0f43fb2d4169c358cd662b54e91a4a2d8db3d4c1de2e9b679cdaece3463535ec65cb46fa68ce863a43fd8eb60895b49a7d06cda3ae950505f86c4199c33cb30d2fb4656e700c52dcc53bb9205df723ee7fe956"; // I incremented the last nibble
    let sig_truth = "8ced7004e6dd8e421ec2009234807e93987739ea4556a7e142c5077cee1f02278639de805137447b3dd15d3260fc0d2ba7a563b0938b6bad9deee1d5da9b4cc4a692da691157ce8bcd782383d209fd1fad31157cab342f4cc1a6789d109a089acb9be55a6d4b4a8705ab7ebaedd89692791004250bb5727c9030305e24f197f69e0e64e1e724117f37a216d3ba76e8decf002a1f7b88017f3894712cf30862123dbef76ebb44ef03fa3dff0e0b1498220e41064b452f46422587a51cec9b63bed7f5887149889037f191eb1a47284578ab215644b237f7376f6c13321ee57aa8ec2b6180370dee50cc03d4ab604504620ba61e8f028c6f32fc91d33a0aafd81a0fe421c50218a8a97b677d74491b9d9294cb1820a7fc4555a34eff5861cb8c0afd877a64dfdcd5606327c0acb144cf40cdd76280ab3bdfc66accf1a7eecd663453e4b7d610242bfac2af9cd7a5219187c3a4247953313d5d0696b7a1336e78f48412182b9184f33c5bc3bcdf39ede62f4c0e36094f53b97fa27d896bb39f21f76b52a758b521ac77190f8ef84a077f642f538e1d9b7e4338e4a3a378d46c0b804c001e1cdc1843221a016920fdf5132ca407506a45e836d3aab03143b3f5b4d6ba330a0d9eac50f5a238d72640da256122bf329ac86bd215afe6286a5add14219af768a4dd6e292490b8e0ee25e470c9577ba5810395328eb980c5932b47232f303d73192e77dc4b3fd8a49f5bfe0447b24006aa27d18dc7b09222bcf19c117d3aab745840d4133dcb22d5adc9ed16fd803eb33f9c85c7f12284190ad63cd5314d42484860befd24479db1b8f75be4e76e6fcd982ab6203549702f497a25495446816e1eba257452c03cf72fd8bd955c620a031fb421a6b12d657a6a958e7fbca5cb2deb5d240e02fc0fa292593ebbf826653b39b1092b7cbd3c919c4b1999b7fdbe54476b302174e4876d6ab970a333072b71d6fa68323ec9c26594cbac595d75fd0fa07bcc3a6d6e240e56c7d0dc7e5e4affe8ab4cf799ad058c9f8bd79da000aeaae9a31f4ad70d4f81b37b272770a34c8fb0fb1896ab1724612c0f271da474c45d19993ea681c5e95295ed9693cb50eca9033a66b5146e8d92665c7badc721d3f445230d95d6b0261b12be4a874f4c3efac4d712b9d5c9d96cd1a60f14eaaa299bea4166c8108c1bfc35769d7c28cbe3a7a554e4585c9de9cc9766643cd358ecc70a736f7c9ad859f8b62975c812946be87c92d57b857efbd70b61f7d64fbc3e4fbe284cf87571679d00dcd70ae665fc05b60ab8590160dff2abd6c0b8fc3d4ca9ba1c67d628fb334643ef7b7686f39e8fb089e10e41b584c4e754e786ac714e87df631aa05411dcb8d2f8ec9b8ec42491fd565893140604ebe120234bf002fcc42344c862f1c9e5467b346b69683456477d25da14490d9a0d97c52927f6ffbc33e896c702c6d7543903e0bbafb7dc98b9f5b276234905d71220b7c39dc38206d7c3cf71f01e272d436338a7ed640c1838375007c3d261ea2dc2e67e71e102c2d040fcebc28712285e79e3065f28ecf619bc45dd4aec87d64d9ab8c8b4acee89ea40ca6801ccdc5a91353f12699a6c8e1665b12e0d419f6b153cd846e456fa53d6a1c16a76c1cbd10d3f131537975a26571ff98f66e2b49d4313e250475b9d379286a0ec8d4c464f875401a34d58a1fe630215c329a3880550d5c1d5973a09b82ee17d308d738a9dcda140405f7a3c600808e767e89d4a134f27b266b8bb3443cd6dc77bd02df41cbbdee30b3059317cf91d58ee2b0702ce500bd3abbff86666b30951488f090fcc2a669272b0b0aade3e7042b6fd6ed30440d5a57c69573a199b4b940de6fbb20fb4e1f4c35e95c2fa00c46ab138edf78566ec998bec7101cf12e04015e3229704728d261356b825e00f4f46e03b63e1affa7491079912e57127f2fe265ccd310df25e12c28ca18feb46bf9a2081fc8ff612c63a0b82f345f8f830418fb131d54367272242c4c9744467ebf395d75c0b7620943204a68f759fb8c89b545f8baa18121458e6ecc70d87116c61d977954139d8401d109440ff5c53db96c5ae7218de2f98a64a2cc834248d8393c034a76edcf408ec30aca68d29a43cf48d41222e74c7224e154de7ec34362c15433927d2b42f4cee2b3a24165448ebf1349a926719c91519d7f00ca639c7ed36d6c1fa875a5de4bb6ca52826d84037d04a98993bade17421a6a5fd71cc9724c3d47b007087bf6bd44c6e8ba6305b470bcbb91f0269a9ccbe94b5cacd2c37a4e82cd7d69fa1b134f9f3604214c4e08ef1479d41af46a5bb26eab0dc702266501e4d90b8113f2fcaf903abfd2a8e7f39616c4150521aeea7c44957538bbf12950c9eb6b6bde852b0dc873430e902bf7647fc86d86715f5fadcc4241dc74681affc4ae621942ad030f711a6b018fad3b97b0f0b3b95698d75e264f61b534271c16587464f6686137e9b53423c7ff7416c228bd7e3710d5c174e53e4e5f9f2f7602619bc528fffa777dd3102dd5fea65eaf9ae5cf9c33af86b0dd50ee15025f328ec065f94e4ccea8ac9c05339c23f22ec50f06b8f9f42b7a259d9f83ba89cd4be59062b46a2f00a881d0e042cfff5f2b2958ee1ba7eb4551050ffebed2ce8c4782a583ed9b1ed9808e06527cdac61d78a52d98eadc23936704343a9d1b7df6e46864134c6b927d2ed865ecb9b037b8de7917ee347230aaae4826fa3899f7a8ca639ee27580d8d1632a7bd6416bd6a96c88efe4511fd88dcf627ce100c0276582a9e0d195b814e6c1dc4347c2a8ba459eceefee432238868828f765777d365cb3f4e24b69cb10c4554988e3eff77213c08ffa9ab279a8aab92691f1e366bc8b5577d08501fa4d90b2dae82ac8f3a5d689cef342b9b0faf7274bf7597c88a8eb9368ab910b189b683ff81ceaf0b24c598bc9462ae1fc07e27afe5c92e67051e47375e3d52feb455fce743ee64b930f7b16c47f1116a0968aec77d0d05950dfb6dda65ce042951414b220966cb3bd5b650edaf1a1020ba460170591bbe918f8d8660627384031720dd1e775afe67191e3fc0dd2522893da6e4a7d1eae0150d6b8d8de2ee0bdf43ee84a6e0b0fd259f1fa42d4e51b608e878866222a3de10f67ba8124c40d65eee7d2db6670f5eb21e3a87d318009bd437b0f770ee3403b614ead64429a7c59643d533e77dbf86f6336e34205098618b8f12c197e6fab51a4ca7b81297491b34da54209a007011bf1d04f4e99eaf7dedc9695e090ed1769a0759de5726f62a5e799c3c221c7ed897121a1e2c5e6468698c9dabb0c7dae8043e4652595a6794a3b9c1d4dce8fcfd183c414447728296a9b6bfdbf83a404a516a76797e8eb8bec3fe00000000000000000000000000000000000000000000000f1f2c39";
    let c =cryptography_service::mldsa2_verify(pub_truth.to_string(), m, sig_truth.to_string()).unwrap();
    let mut v = false;
    if c == (){
        v = true;
    }
    assert_eq!(v, false);
    let cb = cryptography_service::bmldsa2_verify(decode(pub_truth.to_string()).unwrap(), m.as_bytes(), decode(sig_truth.to_string()).unwrap()).unwrap();
    let mut vb = false;
    if cb == (){
        vb = true;
    }
    assert_eq!(vb, true);
}

#[test]
#[should_panic]
fn verify_fail_test_sig_wrong() {
    let m = "lametestmessage";
    let pub_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb3ef540d636d4a9c311ff98e5657d054d08ce36d92597eda8fc22e305603e92569bb0facbedbc045ed3f881ff0ebe1aa5568fff2fd2e2ee0c630c7963fd2d719eafd9b290d8d5828476b591f47fdab49b91c7b4df6cb3db46693667e09a0df26bd063bb207951b616280cd1d89a4ca996f27299692880c365b60dcc07c1ac0519e84588f2c8d99e5267d0e1ddce90dd18f9211fd95385da1ac188789fb1f3fe0042cc8013c147983bb46b10539a8f7f56cfd07c75c582a1ac94166ab0c6ce727c892839f589866be566bafb41e23bcff2126b0cdcf7684e56365f061a8eb2a92d8dfec03b7a7fddada90ec1224feb0dd7567ae79f3eeb193fc0e2dacb951671ce263b0f09f471794d7bc5ec71f8c69b092039502cf51daa601a2c6b1e985b758f36a9e948e326aa7d197423a3384699c4ba2b750373376855b615b47c910c757b8c7a6d6e79d91a79b2015052423ecd33d20927d4ac29a98a50b8152c042a68844dd1ef780179734b57ab17039a5f123bbe2c72920887e8793810f9e1205b561d53e6b4f6deaa06dc93981e3121881b0d457798f979f0999ae1b226f8155ad0173915d49f393394228ee1f1f735d09cc15ce6eaf8a3a6f19a67ef16071c9815eafc76233e00e45c04e622b502a8fd5a1d9f2941f8ee4d0cf5e7d69f2679b6a528ddd2671133dcfcc5ee23bf5a548064817af5ce0b3892e8f34aafba84476696b472076bde9281ae544d3e43b4145ec076b53d5f7d5c8bc2831062edc11f043edf29f05398a6f160ee1b0b016d8bb0b1c23e828c4fdd90708128adf4d70100f75f36065812f6cbe5e9577af1ec548e49206c8a41c229ecd5ac7d0a487c6d921f3e59bacd0a172b67191fec028b4f958840bdf09c43b674380fe7da9f465ce4c4d3d05e8b3504d4125f286bcde1281c7857b8d4e6c14e1e671c8e4068ed1d3e82940ab8ede7afbb9d8f0bf7987bd07401cea32a27ed46bf44ccd3670a9ea49cf037f89f4422a34a8a53afce1ba61ef3c20a9be55b5bb4e67df5cb95d3a17443c195c3ec66cc2515d2c12d7a6c824e1834643621caace611cd1695eb16acdf930d0480a555968c0f882f8d99df8592333868cae4cdf85d93f0118fd07f03cea257cfe4382ef51736f1c1f5a07f7e1dede4e8f9fcd8fbabac4bf9d8a2f08ea1a4a03ec866ac519872f4e4b83023cadd770b9b45cad57a6e5808a6d875f108155c2db9cc05d6eadba204db34efadc2e18da01f691a24cfb31de961bc8f357fe974ba4bee7c943b28ad041464ac0632096ffefcdaead26453861095b54e0f97ed26bf8bc8966441755013d02139723a7f248b165a7a814e67691660a02a322939ed469bdbfc28997f9226123a7191f4adf7287b95e2b64cb18ab5599399646861e8f085c6c201e0c56a46c5c0a9bdd28974dc5f98b1e59ae02b6276c9f4d2236f91ede49907a0f3e74f7649079253108c4a0d667e61eca0cc371e19f36019614752a574c87f4f6e04299fc4867e8b82b439297f6ca7fb04245d87fc21ce4d6080712b12a9e6f64ab18c9f3589f18cb690f04c65db438e2141f70a981c478fc7fb05e2d5e8ef3b3dea9877cf0d76bd030c92a1e30c9e3aae03a1e254c2b9f3b15294ba7c172e0eb9fc042ee58037f548522853f71a87738cb6f0c5ba0057cc4a1299428e36bda12ee12c78f22bf148ab91f0f43fb2d4169c358cd662b54e91a4a2d8db3d4c1de2e9b679cdaece3463535ec65cb46fa68ce863a43fd8eb60895b49a7d06cda3ae950505f86c4199c33cb30d2fb4656e700c52dcc53bb9205df723ee7fe955"; 
    let sig_truth = "8ced7004e6dd8e421ec2009234807e93987739ea4556a7e142c5077cee1f02278639de805137447b3dd15d3260fc0d2ba7a563b0938b6bad9deee1d5da9b4cc4a692da691157ce8bcd782383d209fd1fad31157cab342f4cc1a6789d109a089acb9be55a6d4b4a8705ab7ebaedd89692791004250bb5727c9030305e24f197f69e0e64e1e724117f37a216d3ba76e8decf002a1f7b88017f3894712cf30862123dbef76ebb44ef03fa3dff0e0b1498220e41064b452f46422587a51cec9b63bed7f5887149889037f191eb1a47284578ab215644b237f7376f6c13321ee57aa8ec2b6180370dee50cc03d4ab604504620ba61e8f028c6f32fc91d33a0aafd81a0fe421c50218a8a97b677d74491b9d9294cb1820a7fc4555a34eff5861cb8c0afd877a64dfdcd5606327c0acb144cf40cdd76280ab3bdfc66accf1a7eecd663453e4b7d610242bfac2af9cd7a5219187c3a4247953313d5d0696b7a1336e78f48412182b9184f33c5bc3bcdf39ede62f4c0e36094f53b97fa27d896bb39f21f76b52a758b521ac77190f8ef84a077f642f538e1d9b7e4338e4a3a378d46c0b804c001e1cdc1843221a016920fdf5132ca407506a45e836d3aab03143b3f5b4d6ba330a0d9eac50f5a238d72640da256122bf329ac86bd215afe6286a5add14219af768a4dd6e292490b8e0ee25e470c9577ba5810395328eb980c5932b47232f303d73192e77dc4b3fd8a49f5bfe0447b24006aa27d18dc7b09222bcf19c117d3aab745840d4133dcb22d5adc9ed16fd803eb33f9c85c7f12284190ad63cd5314d42484860befd24479db1b8f75be4e76e6fcd982ab6203549702f497a25495446816e1eba257452c03cf72fd8bd955c620a031fb421a6b12d657a6a958e7fbca5cb2deb5d240e02fc0fa292593ebbf826653b39b1092b7cbd3c919c4b1999b7fdbe54476b302174e4876d6ab970a333072b71d6fa68323ec9c26594cbac595d75fd0fa07bcc3a6d6e240e56c7d0dc7e5e4affe8ab4cf799ad058c9f8bd79da000aeaae9a31f4ad70d4f81b37b272770a34c8fb0fb1896ab1724612c0f271da474c45d19993ea681c5e95295ed9693cb50eca9033a66b5146e8d92665c7badc721d3f445230d95d6b0261b12be4a874f4c3efac4d712b9d5c9d96cd1a60f14eaaa299bea4166c8108c1bfc35769d7c28cbe3a7a554e4585c9de9cc9766643cd358ecc70a736f7c9ad859f8b62975c812946be87c92d57b857efbd70b61f7d64fbc3e4fbe284cf87571679d00dcd70ae665fc05b60ab8590160dff2abd6c0b8fc3d4ca9ba1c67d628fb334643ef7b7686f39e8fb089e10e41b584c4e754e786ac714e87df631aa05411dcb8d2f8ec9b8ec42491fd565893140604ebe120234bf002fcc42344c862f1c9e5467b346b69683456477d25da14490d9a0d97c52927f6ffbc33e896c702c6d7543903e0bbafb7dc98b9f5b276234905d71220b7c39dc38206d7c3cf71f01e272d436338a7ed640c1838375007c3d261ea2dc2e67e71e102c2d040fcebc28712285e79e3065f28ecf619bc45dd4aec87d64d9ab8c8b4acee89ea40ca6801ccdc5a91353f12699a6c8e1665b12e0d419f6b153cd846e456fa53d6a1c16a76c1cbd10d3f131537975a26571ff98f66e2b49d4313e250475b9d379286a0ec8d4c464f875401a34d58a1fe630215c329a3880550d5c1d5973a09b82ee17d308d738a9dcda140405f7a3c600808e767e89d4a134f27b266b8bb3443cd6dc77bd02df41cbbdee30b3059317cf91d58ee2b0702ce500bd3abbff86666b30951488f090fcc2a669272b0b0aade3e7042b6fd6ed30440d5a57c69573a199b4b940de6fbb20fb4e1f4c35e95c2fa00c46ab138edf78566ec998bec7101cf12e04015e3229704728d261356b825e00f4f46e03b63e1affa7491079912e57127f2fe265ccd310df25e12c28ca18feb46bf9a2081fc8ff612c63a0b82f345f8f830418fb131d54367272242c4c9744467ebf395d75c0b7620943204a68f759fb8c89b545f8baa18121458e6ecc70d87116c61d977954139d8401d109440ff5c53db96c5ae7218de2f98a64a2cc834248d8393c034a76edcf408ec30aca68d29a43cf48d41222e74c7224e154de7ec34362c15433927d2b42f4cee2b3a24165448ebf1349a926719c91519d7f00ca639c7ed36d6c1fa875a5de4bb6ca52826d84037d04a98993bade17421a6a5fd71cc9724c3d47b007087bf6bd44c6e8ba6305b470bcbb91f0269a9ccbe94b5cacd2c37a4e82cd7d69fa1b134f9f3604214c4e08ef1479d41af46a5bb26eab0dc702266501e4d90b8113f2fcaf903abfd2a8e7f39616c4150521aeea7c44957538bbf12950c9eb6b6bde852b0dc873430e902bf7647fc86d86715f5fadcc4241dc74681affc4ae621942ad030f711a6b018fad3b97b0f0b3b95698d75e264f61b534271c16587464f6686137e9b53423c7ff7416c228bd7e3710d5c174e53e4e5f9f2f7602619bc528fffa777dd3102dd5fea65eaf9ae5cf9c33af86b0dd50ee15025f328ec065f94e4ccea8ac9c05339c23f22ec50f06b8f9f42b7a259d9f83ba89cd4be59062b46a2f00a881d0e042cfff5f2b2958ee1ba7eb4551050ffebed2ce8c4782a583ed9b1ed9808e06527cdac61d78a52d98eadc23936704343a9d1b7df6e46864134c6b927d2ed865ecb9b037b8de7917ee347230aaae4826fa3899f7a8ca639ee27580d8d1632a7bd6416bd6a96c88efe4511fd88dcf627ce100c0276582a9e0d195b814e6c1dc4347c2a8ba459eceefee432238868828f765777d365cb3f4e24b69cb10c4554988e3eff77213c08ffa9ab279a8aab92691f1e366bc8b5577d08501fa4d90b2dae82ac8f3a5d689cef342b9b0faf7274bf7597c88a8eb9368ab910b189b683ff81ceaf0b24c598bc9462ae1fc07e27afe5c92e67051e47375e3d52feb455fce743ee64b930f7b16c47f1116a0968aec77d0d05950dfb6dda65ce042951414b220966cb3bd5b650edaf1a1020ba460170591bbe918f8d8660627384031720dd1e775afe67191e3fc0dd2522893da6e4a7d1eae0150d6b8d8de2ee0bdf43ee84a6e0b0fd259f1fa42d4e51b608e878866222a3de10f67ba8124c40d65eee7d2db6670f5eb21e3a87d318009bd437b0f770ee3403b614ead64429a7c59643d533e77dbf86f6336e34205098618b8f12c197e6fab51a4ca7b81297491b34da54209a007011bf1d04f4e99eaf7dedc9695e090ed1769a0759de5726f62a5e799c3c221c7ed897121a1e2c5e6468698c9dabb0c7dae8043e4652595a6794a3b9c1d4dce8fcfd183c414447728296a9b6bfdbf83a404a516a76797e8eb8bec3fe00000000000000000000000000000000000000000000000f1f2c3a"; // I incremented the last nibble of the sig
    let c =cryptography_service::mldsa2_verify(pub_truth.to_string(), m, sig_truth.to_string()).unwrap();
    let mut v = false;
    if c == (){
        v = true;
    }
    assert_eq!(v, false);
    let cb = cryptography_service::bmldsa2_verify(decode(pub_truth.to_string()).unwrap(), m.as_bytes(), decode(sig_truth.to_string()).unwrap()).unwrap();
    let mut vb = false;
    if cb == (){
        vb = true;
    }
    assert_eq!(vb, true);
}

#[test]
#[should_panic]
fn verify_fail_test_msg_wrong() {
    let m = "lametestmassage"; // altered one character of message
    let pub_truth = "efc197cefd25768763d1bcd05fa4ba2d4a3fe1cb358ff64f3f1a9f5fc7574fb3ef540d636d4a9c311ff98e5657d054d08ce36d92597eda8fc22e305603e92569bb0facbedbc045ed3f881ff0ebe1aa5568fff2fd2e2ee0c630c7963fd2d719eafd9b290d8d5828476b591f47fdab49b91c7b4df6cb3db46693667e09a0df26bd063bb207951b616280cd1d89a4ca996f27299692880c365b60dcc07c1ac0519e84588f2c8d99e5267d0e1ddce90dd18f9211fd95385da1ac188789fb1f3fe0042cc8013c147983bb46b10539a8f7f56cfd07c75c582a1ac94166ab0c6ce727c892839f589866be566bafb41e23bcff2126b0cdcf7684e56365f061a8eb2a92d8dfec03b7a7fddada90ec1224feb0dd7567ae79f3eeb193fc0e2dacb951671ce263b0f09f471794d7bc5ec71f8c69b092039502cf51daa601a2c6b1e985b758f36a9e948e326aa7d197423a3384699c4ba2b750373376855b615b47c910c757b8c7a6d6e79d91a79b2015052423ecd33d20927d4ac29a98a50b8152c042a68844dd1ef780179734b57ab17039a5f123bbe2c72920887e8793810f9e1205b561d53e6b4f6deaa06dc93981e3121881b0d457798f979f0999ae1b226f8155ad0173915d49f393394228ee1f1f735d09cc15ce6eaf8a3a6f19a67ef16071c9815eafc76233e00e45c04e622b502a8fd5a1d9f2941f8ee4d0cf5e7d69f2679b6a528ddd2671133dcfcc5ee23bf5a548064817af5ce0b3892e8f34aafba84476696b472076bde9281ae544d3e43b4145ec076b53d5f7d5c8bc2831062edc11f043edf29f05398a6f160ee1b0b016d8bb0b1c23e828c4fdd90708128adf4d70100f75f36065812f6cbe5e9577af1ec548e49206c8a41c229ecd5ac7d0a487c6d921f3e59bacd0a172b67191fec028b4f958840bdf09c43b674380fe7da9f465ce4c4d3d05e8b3504d4125f286bcde1281c7857b8d4e6c14e1e671c8e4068ed1d3e82940ab8ede7afbb9d8f0bf7987bd07401cea32a27ed46bf44ccd3670a9ea49cf037f89f4422a34a8a53afce1ba61ef3c20a9be55b5bb4e67df5cb95d3a17443c195c3ec66cc2515d2c12d7a6c824e1834643621caace611cd1695eb16acdf930d0480a555968c0f882f8d99df8592333868cae4cdf85d93f0118fd07f03cea257cfe4382ef51736f1c1f5a07f7e1dede4e8f9fcd8fbabac4bf9d8a2f08ea1a4a03ec866ac519872f4e4b83023cadd770b9b45cad57a6e5808a6d875f108155c2db9cc05d6eadba204db34efadc2e18da01f691a24cfb31de961bc8f357fe974ba4bee7c943b28ad041464ac0632096ffefcdaead26453861095b54e0f97ed26bf8bc8966441755013d02139723a7f248b165a7a814e67691660a02a322939ed469bdbfc28997f9226123a7191f4adf7287b95e2b64cb18ab5599399646861e8f085c6c201e0c56a46c5c0a9bdd28974dc5f98b1e59ae02b6276c9f4d2236f91ede49907a0f3e74f7649079253108c4a0d667e61eca0cc371e19f36019614752a574c87f4f6e04299fc4867e8b82b439297f6ca7fb04245d87fc21ce4d6080712b12a9e6f64ab18c9f3589f18cb690f04c65db438e2141f70a981c478fc7fb05e2d5e8ef3b3dea9877cf0d76bd030c92a1e30c9e3aae03a1e254c2b9f3b15294ba7c172e0eb9fc042ee58037f548522853f71a87738cb6f0c5ba0057cc4a1299428e36bda12ee12c78f22bf148ab91f0f43fb2d4169c358cd662b54e91a4a2d8db3d4c1de2e9b679cdaece3463535ec65cb46fa68ce863a43fd8eb60895b49a7d06cda3ae950505f86c4199c33cb30d2fb4656e700c52dcc53bb9205df723ee7fe955"; 
    let sig_truth = "8ced7004e6dd8e421ec2009234807e93987739ea4556a7e142c5077cee1f02278639de805137447b3dd15d3260fc0d2ba7a563b0938b6bad9deee1d5da9b4cc4a692da691157ce8bcd782383d209fd1fad31157cab342f4cc1a6789d109a089acb9be55a6d4b4a8705ab7ebaedd89692791004250bb5727c9030305e24f197f69e0e64e1e724117f37a216d3ba76e8decf002a1f7b88017f3894712cf30862123dbef76ebb44ef03fa3dff0e0b1498220e41064b452f46422587a51cec9b63bed7f5887149889037f191eb1a47284578ab215644b237f7376f6c13321ee57aa8ec2b6180370dee50cc03d4ab604504620ba61e8f028c6f32fc91d33a0aafd81a0fe421c50218a8a97b677d74491b9d9294cb1820a7fc4555a34eff5861cb8c0afd877a64dfdcd5606327c0acb144cf40cdd76280ab3bdfc66accf1a7eecd663453e4b7d610242bfac2af9cd7a5219187c3a4247953313d5d0696b7a1336e78f48412182b9184f33c5bc3bcdf39ede62f4c0e36094f53b97fa27d896bb39f21f76b52a758b521ac77190f8ef84a077f642f538e1d9b7e4338e4a3a378d46c0b804c001e1cdc1843221a016920fdf5132ca407506a45e836d3aab03143b3f5b4d6ba330a0d9eac50f5a238d72640da256122bf329ac86bd215afe6286a5add14219af768a4dd6e292490b8e0ee25e470c9577ba5810395328eb980c5932b47232f303d73192e77dc4b3fd8a49f5bfe0447b24006aa27d18dc7b09222bcf19c117d3aab745840d4133dcb22d5adc9ed16fd803eb33f9c85c7f12284190ad63cd5314d42484860befd24479db1b8f75be4e76e6fcd982ab6203549702f497a25495446816e1eba257452c03cf72fd8bd955c620a031fb421a6b12d657a6a958e7fbca5cb2deb5d240e02fc0fa292593ebbf826653b39b1092b7cbd3c919c4b1999b7fdbe54476b302174e4876d6ab970a333072b71d6fa68323ec9c26594cbac595d75fd0fa07bcc3a6d6e240e56c7d0dc7e5e4affe8ab4cf799ad058c9f8bd79da000aeaae9a31f4ad70d4f81b37b272770a34c8fb0fb1896ab1724612c0f271da474c45d19993ea681c5e95295ed9693cb50eca9033a66b5146e8d92665c7badc721d3f445230d95d6b0261b12be4a874f4c3efac4d712b9d5c9d96cd1a60f14eaaa299bea4166c8108c1bfc35769d7c28cbe3a7a554e4585c9de9cc9766643cd358ecc70a736f7c9ad859f8b62975c812946be87c92d57b857efbd70b61f7d64fbc3e4fbe284cf87571679d00dcd70ae665fc05b60ab8590160dff2abd6c0b8fc3d4ca9ba1c67d628fb334643ef7b7686f39e8fb089e10e41b584c4e754e786ac714e87df631aa05411dcb8d2f8ec9b8ec42491fd565893140604ebe120234bf002fcc42344c862f1c9e5467b346b69683456477d25da14490d9a0d97c52927f6ffbc33e896c702c6d7543903e0bbafb7dc98b9f5b276234905d71220b7c39dc38206d7c3cf71f01e272d436338a7ed640c1838375007c3d261ea2dc2e67e71e102c2d040fcebc28712285e79e3065f28ecf619bc45dd4aec87d64d9ab8c8b4acee89ea40ca6801ccdc5a91353f12699a6c8e1665b12e0d419f6b153cd846e456fa53d6a1c16a76c1cbd10d3f131537975a26571ff98f66e2b49d4313e250475b9d379286a0ec8d4c464f875401a34d58a1fe630215c329a3880550d5c1d5973a09b82ee17d308d738a9dcda140405f7a3c600808e767e89d4a134f27b266b8bb3443cd6dc77bd02df41cbbdee30b3059317cf91d58ee2b0702ce500bd3abbff86666b30951488f090fcc2a669272b0b0aade3e7042b6fd6ed30440d5a57c69573a199b4b940de6fbb20fb4e1f4c35e95c2fa00c46ab138edf78566ec998bec7101cf12e04015e3229704728d261356b825e00f4f46e03b63e1affa7491079912e57127f2fe265ccd310df25e12c28ca18feb46bf9a2081fc8ff612c63a0b82f345f8f830418fb131d54367272242c4c9744467ebf395d75c0b7620943204a68f759fb8c89b545f8baa18121458e6ecc70d87116c61d977954139d8401d109440ff5c53db96c5ae7218de2f98a64a2cc834248d8393c034a76edcf408ec30aca68d29a43cf48d41222e74c7224e154de7ec34362c15433927d2b42f4cee2b3a24165448ebf1349a926719c91519d7f00ca639c7ed36d6c1fa875a5de4bb6ca52826d84037d04a98993bade17421a6a5fd71cc9724c3d47b007087bf6bd44c6e8ba6305b470bcbb91f0269a9ccbe94b5cacd2c37a4e82cd7d69fa1b134f9f3604214c4e08ef1479d41af46a5bb26eab0dc702266501e4d90b8113f2fcaf903abfd2a8e7f39616c4150521aeea7c44957538bbf12950c9eb6b6bde852b0dc873430e902bf7647fc86d86715f5fadcc4241dc74681affc4ae621942ad030f711a6b018fad3b97b0f0b3b95698d75e264f61b534271c16587464f6686137e9b53423c7ff7416c228bd7e3710d5c174e53e4e5f9f2f7602619bc528fffa777dd3102dd5fea65eaf9ae5cf9c33af86b0dd50ee15025f328ec065f94e4ccea8ac9c05339c23f22ec50f06b8f9f42b7a259d9f83ba89cd4be59062b46a2f00a881d0e042cfff5f2b2958ee1ba7eb4551050ffebed2ce8c4782a583ed9b1ed9808e06527cdac61d78a52d98eadc23936704343a9d1b7df6e46864134c6b927d2ed865ecb9b037b8de7917ee347230aaae4826fa3899f7a8ca639ee27580d8d1632a7bd6416bd6a96c88efe4511fd88dcf627ce100c0276582a9e0d195b814e6c1dc4347c2a8ba459eceefee432238868828f765777d365cb3f4e24b69cb10c4554988e3eff77213c08ffa9ab279a8aab92691f1e366bc8b5577d08501fa4d90b2dae82ac8f3a5d689cef342b9b0faf7274bf7597c88a8eb9368ab910b189b683ff81ceaf0b24c598bc9462ae1fc07e27afe5c92e67051e47375e3d52feb455fce743ee64b930f7b16c47f1116a0968aec77d0d05950dfb6dda65ce042951414b220966cb3bd5b650edaf1a1020ba460170591bbe918f8d8660627384031720dd1e775afe67191e3fc0dd2522893da6e4a7d1eae0150d6b8d8de2ee0bdf43ee84a6e0b0fd259f1fa42d4e51b608e878866222a3de10f67ba8124c40d65eee7d2db6670f5eb21e3a87d318009bd437b0f770ee3403b614ead64429a7c59643d533e77dbf86f6336e34205098618b8f12c197e6fab51a4ca7b81297491b34da54209a007011bf1d04f4e99eaf7dedc9695e090ed1769a0759de5726f62a5e799c3c221c7ed897121a1e2c5e6468698c9dabb0c7dae8043e4652595a6794a3b9c1d4dce8fcfd183c414447728296a9b6bfdbf83a404a516a76797e8eb8bec3fe00000000000000000000000000000000000000000000000f1f2c3a"; // I incremented the last nibble of the sig
    let c =cryptography_service::mldsa2_verify(pub_truth.to_string(), m, sig_truth.to_string()).unwrap();
    let mut v = false;
    if c == (){
        v = true;
    }
    assert_eq!(v, false);
    let cb = cryptography_service::bmldsa2_verify(decode(pub_truth.to_string()).unwrap(), m.as_bytes(), decode(sig_truth.to_string()).unwrap()).unwrap();
    let mut vb = false;
    if cb == (){
        vb = true;
    }
    assert_eq!(vb, true);
}


